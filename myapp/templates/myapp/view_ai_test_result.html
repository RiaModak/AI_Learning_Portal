{% extends 'myapp/base.html' %}

{% block content %}
<div class="container mt-4">
    <h3>AI Test Result (QnA ID: {{ qna_id }})</h3>

    <!-- Overall Score -->
    <p class="mt-2"><strong>Overall Score:</strong> {{ overall_score }} / {{ overall_total }}</p>

    <!-- Section Scores -->
    <p><strong>MCQ Score:</strong> {{ mcq_score }} / {{ mcq_total }}</p>
    <p><strong>Descriptive Score:</strong> {{ desc_score }} / {{ desc_total }}</p>

    <!-- MCQ Questions -->
    {% if mcqs %}
        <h4 class="mt-4">Multiple Choice Questions:</h4>
        {% for ans in mcqs %}
            <div class="mb-3 p-3 border rounded">
                <p><strong>Q{{ forloop.counter }}:</strong> {{ ans.question_text }}</p>
                <p>
                    Your Answer: <strong>{{ ans.selected_option|upper }}</strong>
                    {% if ans.is_correct %}
                        <span class="text-success">✅ Correct</span>
                    {% else %}
                        <span class="text-danger">❌ Incorrect</span>
                        (Correct: <strong>{{ ans.correct_option|upper }}</strong>)
                    {% endif %}
                </p>
            </div>
        {% endfor %}
    {% endif %}

    <!-- Descriptive Questions -->
    {% if descriptive %}
        <h4 class="mt-4">Descriptive Questions:</h4>
        {% for ans in descriptive %}
            <div class="mb-4 p-3 border rounded">
                <p><strong>Q{{ forloop.counter }}:</strong> {{ ans.question_text }}</p>
                <p><strong>Your Answer:</strong> {{ ans.descriptive_answer }}</p>

                {% if ans.score is not None %}
                    <p><strong>Score:</strong> {{ ans.score }} / 5</p>
                {% endif %}

                {% if ans.feedback %}
                    <p><strong>Feedback:</strong> {{ ans.feedback }}</p>
                {% endif %}
            </div>
        {% endfor %}
    {% else %}
        <p>No descriptive answers found.</p>
    {% endif %}
</div>
{% endblock %}
